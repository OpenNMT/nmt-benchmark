function getDescription(){var e={};return $(".ui.form input, .ui.form textarea").each(function(t,r){e[$(r).attr("name")]=$(r).val()}),e}function setDescription(e){$(".ui.form input, .ui.form textarea").each(function(t,r){var o=$(r).attr("name");$(r).val(e[o]||""),$(r).attr("placeholder",""),$(r).attr("disabled",!0)})}function confirm(e){$(".ui.modal").modal({blurring:!0,onApprove:function(){$.get(e.url).success(function(t){try{t=JSON.parse(t)}catch(e){console.log("Unable to parse server response, should be a JSON object already")}if(t.error){var r="error";if(t.error.errors){var o="";for(var n in t.error.errors)t.error.errors.hasOwnProperty(n)&&(o+=t.error.errors[n].message);flash(r,o)}else flash(r,t.error)}else e.done()}).fail(function(e){var t="error";flash(t,e),console.log(e.trace)})},onShow:function(){$("#dialogHeader").text(e.header),$("#dialogDescription").text(e.content)},onVisible:function(){$(".ui.modal").find(".cancel.button").focus()},onHidden:function(){$(e.$target).focus()}}).modal("show")}$(document).ready(function(){"view"===mode&&($(".ui.form .input").addClass("transparent"),setDescription(translationSystem)),$(".ui.dropdown").dropdown(),$(".ui.toggle.checkbox").checkbox({onChange:function(){var e=$(this).prop("checked")?"On":"Off";$(this).next("label").text(e),$(".trainSet").transition({animation:"slide down",duration:"0.5s"})}}),$("#translationSystem .field.required").on("input",function(e){var t=$("#translationSystem .field.required").map(function(){return!!$(this).find("input").val().trim()}).toArray().reduce(function(e,t){return e&&t},!0);t?($("#createSystem").removeClass("disabled"),$("#createSystem").addClass("basic fireBrick")):($("#createSystem").addClass("disabled"),$("#createSystem").removeClass("basic fireBrick"))}),$("#createSystem").on("click",function(){var e=getDescription(),t=e.system_id?"/translationSystem/update":"/translationSystem/create";$.post(t,e).success(function(e){try{e=JSON.parse(e)}catch(e){console.log("Unable to parse server response, should be a JSON object already")}if(e.error){var t="error";if(e.error.errors){var r="";for(var o in e.error.errors)e.error.errors.hasOwnProperty(o)&&(r+=e.error.errors[o].message);flash(t,r)}else flash(t,e.error)}else window.location="/translationSystem/view/"+e.data._id}).fail(function(e){flash("error",e),console.log(e,e.stack)})}),$("#deleteSystem").on("click",function(){var e={url:"/translationSystem/delete/"+translationSystem._id,done:function(){window.location="/"},header:"Are you sure you want to delete this system?",content:"All associated translations and scores will be lost",$target:$(this)};confirm(e)}),$("#createSystem, #deleteSystem, .deleteOutput, .getSource, .selectOutput, .uploadOutput").on("keypress",function(e){13!==e.which&&32!==e.which||(e.preventDefault(),$(e.target).trigger("click"))}),$(document).on("change",":file[name=file]",function(){var e=$(this),t=e.val().replace(/\\/g,"/").replace(/.*\//,""),r=$(this).closest("form");e.trigger("fileselect",[t,r])}),$(":file[name=file]").on("fileselect",function(e,t,r){var o=r.find(".selectOutput"),n=r.find(".uploadOutput");o.find("input").val(t),t?(n.removeClass("disabled"),n.addClass("basic fireBrick")):(n.removeClass("basic fireBrick"),n.addClass("disabled"))}),$(".selectOutput").on("click",function(){var e=$(this).attr("data-fileId");$(':file[data-fileId="'+e+'"]').trigger("click")}),$(".fileName").on("focus",function(){$(this).blur()}),$(".uploadOutput").on("click",function(){$(this).closest("form").submit()}),$(".deleteOutput").on("click",function(){var e={url:"/testOutput/delete/"+$(this).attr("data-testOutputId"),done:function(){location.reload()},header:"Are you sure you want to delete this translation?",content:"All associated scores will be lost",$target:$(this)};confirm(e)}),$(".getSource").on("click",function(){var e=$(this).attr("data-fileId");window.open("/download/test/"+e)}),$(".cancel.button, .ok.button").on("keypress",function(e){13!==e.which&&32!==e.which||(e.preventDefault(),$(e.target).trigger("click"))})});